# Heap

dependecies:
[Heap](../../os/heap.md)

sources:
https://heap-exploitation.dhavalkapil.com/ \
https://www.blackhat.com/presentations/bh-usa-07/Ferguson/Whitepaper/bh-usa-07-ferguson-WP.pdf \
https://stackoverflow.com/questions/12825148/what-is-the-meaning-of-the-term-arena-in-relation-to-memory \
http://lcvdata.com/ads/so-livro.pdf

## Exploitation

Here is a list about the possible attacks. Keep in mind the
[security checks done by library functions](https://heap-exploitation.dhavalkapil.com/diving_into_glibc_heap/security_checks.html).

Links and credits to all go to [Dhaval Kapil](https://dhavalkapil.com/)

Exploit opportunities appear when the developer don't:

* `free` memory obtained with `malloc`

* Do not `free` the same memory more than once

* Ensure that memory usage does not go beyond the amount of memory
requested. Prevent heap overflows.

Attack | Target | Technique |
-------|--------|-----------|
[First Fit](https://heap-exploitation.dhavalkapil.com/attacks/first_fit.html) | Not an attack, just demonstrates how the allocator works | 
[Double Free](https://heap-exploitation.dhavalkapil.com/attacks/double_free.html) | Making `malloc` return an already allocated fastchunk | Disrupt the fastbin by freeing a chunk twice
[Forging Chunks](https://heap-exploitation.dhavalkapil.com/attacks/forging_chunks.html) | Making `malloc` return a nearly arbitrary pointer | Disrupting fastbin link structure
[Unlink Exploit](https://heap-exploitation.dhavalkapil.com/attacks/unlink_exploit.html) | Getting (nearly) arbitrary write access | Freeing a corrupted chunk and exploiting `unlink`
[Shrinking free chunks](https://heap-exploitation.dhavalkapil.com/attacks/shrinking_free_chunks.html) | Making `malloc` return a check overlapping with an already allocated chunk | Corrupting a free chunk by decreasing its size
[House of Spirit](https://heap-exploitation.dhavalkapil.com/attacks/house_of_spirit.html) | Making `malloc` return a nearly arbitrary pointer | Forcing freeing of a crafted fake chunk
[House of Lore](https://heap-exploitation.dhavalkapil.com/attacks/house_of_lore.html) | Making `malloc` return a nearly arbitrary pointer | Disrupting smallbin link structure
[House of Force](https://heap-exploitation.dhavalkapil.com/attacks/house_of_force.html) | Making `malloc` return a nearly arbitrary pointer | Overflowing into top chunk's header
[House of Einherjar](https://heap-exploitation.dhavalkapil.com/attacks/house_of_einherjar.html) | Making `malloc` return a nearly arbitrary pointer | Overflowing a single byte into the next chunk
